## 2026-01-07 - Path Traversal Prevention in File Scanners
**Vulnerability:** The `ArchiveScanner` allowed scanning arbitrary directories, including the filesystem root (`/`) and sensitive system directories (`/etc`, `/proc`, `C:\Windows`), enabling potential information disclosure or DoS via massive scans.
**Learning:** Default-allow for file scanners is dangerous. Using strict blocklists for system roots is necessary. Mocking `pathlib.Path` behavior for cross-platform security testing (e.g. testing Windows paths on Linux) requires careful mocking of `resolve()` and class instantiation, or mocking the underlying `os.name` logic while handling `NotImplementedError` for cross-platform Path classes.
**Prevention:** Implement `is_unsafe_path` using `path.resolve()` to normalize paths and check against a predefined list of unsafe system roots (`/etc`, `/sys`, etc.) and the filesystem anchor. Use dependency injection or mocking to test cross-platform path logic without relying on the host OS filesystem.
